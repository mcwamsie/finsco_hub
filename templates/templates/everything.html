// Form validation
    document.querySelector('form').addEventListener('submit', function(e) {
        const requiredFields = document.querySelectorAll('[required]');
        let isValid = true;

        requiredFields.forEach(field => {
            if (!field.value.trim()) {
                field.classList.add('border-red-500');
                isValid = false;
            } else {
                field.classList.remove('border-red-500');
            }
        });

        if (!isValid) {
            e.preventDefault();
            showNotification('Please fill in all required fields.', 'error');
        }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey || e.metaKey) {
            switch(e.key) {
                case 's':
                    e.preventDefault();
                    document.querySelector('form').submit();
                    break;
            }
        }
    });
</script>
{% endblock %}

# templates/components/modal.html
<!-- Modal Component using Flowbite -->
<div id="record-modal" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative p-4 w-full max-w-2xl max-h-full">
        <!-- Modal content -->
        <div class="relative bg-white rounded-lg shadow">
            <!-- Modal header -->
            <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t">
                <h3 id="modal-title" class="text-xl font-semibold text-gray-900">
                    Record Details
                </h3>
                <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center" data-modal-hide="record-modal">
                    <i class="bi bi-x text-xl"></i>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <!-- Modal body -->
            <div id="modal-body" class="p-4 md:p-5 space-y-4 max-h-96 overflow-y-auto">
                <!-- Content will be loaded here -->
                <div class="text-center py-8">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-airtable-blue mx-auto"></div>
                    <p class="text-gray-500 mt-2">Loading...</p>
                </div>
            </div>
            <!-- Modal footer -->
            <div class="flex items-center justify-end gap-3 p-4 md:p-5 border-t border-gray-200 rounded-b">
                <button data-modal-hide="record-modal" type="button" class="py-2.5 px-5 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100">
                    Cancel
                </button>
                <button id="modal-save-btn" type="button" class="text-white bg-airtable-blue hover:bg-airtable-blue-light focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center">
                    Save Changes
                </button>
            </div>
        </div>
    </div>
</div>

# templates/auth-base.html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock %} - Feedback Management</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'airtable-blue': '#4a67c4',
                        'airtable-blue-light': '#6b82d6'
                    }
                }
            }
        }
    </script>

    <style>
        .gradient-blue {
            background: linear-gradient(135deg, #4a67c4 0%, #6b82d6 100%);
        }
        .auth-pattern {
            background-image:
                radial-gradient(circle at 1px 1px, rgba(74, 103, 196, 0.1) 1px, transparent 0);
            background-size: 20px 20px;
        }
    </style>

    {% block extra_css %}{% endblock %}
</head>
<body class="min-h-screen bg-gray-50 auth-pattern">
    <!-- Header -->
    <div class="bg-white border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-gradient-to-r from-airtable-blue to-airtable-blue-light rounded-lg flex items-center justify-center">
                        <i class="bi bi-bar-chart-fill text-white text-lg"></i>
                    </div>
                    <h1 class="text-xl font-bold text-gray-900">Feedback Management</h1>
                </div>

                <nav class="hidden md:flex items-center gap-6">
                    <a href="#features" class="text-gray-600 hover:text-gray-900 text-sm font-medium">Features</a>
                    <a href="#pricing" class="text-gray-600 hover:text-gray-900 text-sm font-medium">Pricing</a>
                    <a href="#support" class="text-gray-600 hover:text-gray-900 text-sm font-medium">Support</a>
                    {% if not user.is_authenticated %}
                        <a href="{% url 'login' %}" class="text-airtable-blue hover:text-airtable-blue-light text-sm font-medium">
                            Sign In
                        </a>
                        <a href="{% url 'register' %}" class="bg-airtable-blue hover:bg-airtable-blue-light text-white px-4 py-2 rounded-md text-sm font-medium transition-colors">
                            Get Started
                        </a>
                    {% endif %}
                </nav>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="min-h-screen flex">
        <!-- Left Side - Branding/Info -->
        <div class="hidden lg:flex lg:w-1/2 gradient-blue relative overflow-hidden">
            <!-- Background Pattern -->
            <div class="absolute inset-0 opacity-10">
                <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,<svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%23ffffff" fill-opacity="0.1"><circle cx="20" cy="20" r="2"/><circle cx="40" cy="40" r="2"/></g></svg>'); background-size: 60px 60px;"></div>
            </div>

            <div class="relative z-10 flex flex-col justify-center px-12">
                <div class="max-w-md">
                    <div class="flex items-center gap-3 mb-8">
                        <div class="w-12 h-12 bg-white bg-opacity-20 backdrop-blur-sm rounded-xl flex items-center justify-center">
                            <i class="bi bi-bar-chart-fill text-white text-2xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-white">Feedback Management</h2>
                    </div>

                    <h3 class="text-3xl font-bold text-white mb-4 leading-tight">
                        {% block auth_heading %}
                            Organize feedback like never before
                        {% endblock %}
                    </h3>

                    <p class="text-white text-opacity-90 mb-8 leading-relaxed">
                        {% block auth_description %}
                            Streamline your feedback collection, organization, and analysis with our powerful platform. Turn customer insights into actionable improvements.
                        {% endblock %}
                    </p>

                    <!-- Features List -->
                    <div class="space-y-4">
                        <div class="flex items-center gap-3 text-white text-opacity-90">
                            <div class="w-5 h-5 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                <i class="bi bi-check text-xs"></i>
                            </div>
                            <span class="text-sm">Real-time feedback tracking</span>
                        </div>
                        <div class="flex items-center gap-3 text-white text-opacity-90">
                            <div class="w-5 h-5 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                <i class="bi bi-check text-xs"></i>
                            </div>
                            <span class="text-sm">Advanced analytics and reporting</span>
                        </div>
                        <div class="flex items-center gap-3 text-white text-opacity-90">
                            <div class="w-5 h-5 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                <i class="bi bi-check text-xs"></i>
                            </div>
                            <span class="text-sm">Team collaboration tools</span>
                        </div>
                        <div class="flex items-center gap-3 text-white text-opacity-90">
                            <div class="w-5 h-5 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                <i class="bi bi-check text-xs"></i>
                            </div>
                            <span class="text-sm">Automated workflow management</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Side - Auth Form -->
        <div class="flex-1 flex flex-col justify-center px-6 py-12 lg:px-16">
            <div class="mx-auto w-full max-w-md">
                {% block auth_content %}{% endblock %}
            </div>
        </div>
    </div>

    <!-- Messages -->
    {% if messages %}
        <div id="messages" class="fixed top-4 right-4 z-50 space-y-2">
            {% for message in messages %}
                <div class="px-4 py-3 rounded-lg text-white transform transition-all duration-300 {% if message.tags == 'success' %}bg-green-500{% elif message.tags == 'error' %}bg-red-500{% elif message.tags == 'warning' %}bg-yellow-500{% else %}bg-blue-500{% endif %} shadow-lg">
                    <div class="flex items-center gap-2">
                        {% if message.tags == 'success' %}
                            <i class="bi bi-check-circle"></i>
                        {% elif message.tags == 'error' %}
                            <i class="bi bi-exclamation-circle"></i>
                        {% elif message.tags == 'warning' %}
                            <i class="bi bi-exclamation-triangle"></i>
                        {% else %}
                            <i class="bi bi-info-circle"></i>
                        {% endif %}
                        {{ message }}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <script>
        // Auto-hide messages
        document.addEventListener('DOMContentLoaded', function() {
            const messages = document.getElementById('messages');
            if (messages) {
                setTimeout(() => {
                    messages.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        messages.remove();
                    }, 300);
                }, 4000);
            }
        });

        // Form enhancements
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.querySelector('form');
            if (form) {
                const inputs = form.querySelectorAll('input');

                inputs.forEach(input => {
                    // Add focus/blur effects
                    input.addEventListener('focus', function() {
                        this.parentElement.classList.add('ring-2', 'ring-airtable-blue', 'ring-opacity-50');
                    });

                    input.addEventListener('blur', function() {
                        this.parentElement.classList.remove('ring-2', 'ring-airtable-blue', 'ring-opacity-50');
                    });
                });
            }
        });
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>

# templates/auth/login.html
{% extends 'auth-base.html' %}
{% load widget_tweaks %}

{% block title %}Sign In{% endblock %}

{% block auth_heading %}
    Welcome back to your dashboard
{% endblock %}

{% block auth_description %}
    Sign in to access your feedback management workspace and continue organizing customer insights with ease.
{% endblock %}

{% block auth_content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="text-center">
        <h2 class="text-3xl font-bold text-gray-900">Sign in to your account</h2>
        <p class="mt-2 text-sm text-gray-600">
            Or
            <a href="{% url 'register' %}" class="font-medium text-airtable-blue hover:text-airtable-blue-light signup-link disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none">
                create a new account
            </a>
        </p>
    </div>

    <!-- Social Login (Optional) -->
    <div class="space-y-3">
        <button type="button" class="w-full flex justify-center items-center gap-3 px-4 py-3 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-airtable-blue transition-colors social-button disabled:opacity-50 disabled:cursor-not-allowed">
            <svg class="w-5 h-5" viewBox="0 0 24 24">
                <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg>
            <span class="social-text">Continue with Google</span>
            <div class="social-loading hidden flex items-center">
                <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600 mr-2"></div>
                Connecting...
            </div>
        </button>

        <button type="button" class="w-full flex justify-center items-center gap-3 px-4 py-3 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-airtable-blue transition-colors social-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-microsoft text-lg"></i>
            <span class="social-text">Continue with Microsoft</span>
            <div class="social-loading hidden flex items-center">
                <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600 mr-2"></div>
                Connecting...
            </div>
        </button>
    </div>

    <!-- Divider -->
    <div class="relative">
        <div class="absolute inset-0 flex items-center">
            <div class="w-full border-t border-gray-300"></div>
        </div>
        <div class="relative flex justify-center text-sm">
            <span class="px-2 bg-gray-50 text-gray-500">Or continue with email</span>
        </div>
    </div>

    <!-- Loading Overlay for Form -->
    <div id="auth-loading-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-lg p-6 max-w-sm mx-4">
            <div class="flex items-center gap-3">
                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-airtable-blue"></div>
                <span class="text-gray-700 font-medium">Signing you in...</span>
            </div>
            <div class="text-sm text-gray-500 mt-2">Please wait while we authenticate your account.</div>
        </div>
    </div>

    <!-- Login Form -->
    <form method="post" class="space-y-5 login-form" onsubmit="handleLoginSubmit(event)">
        {% csrf_token %}

        <!-- Email Field -->
        <div>
            <label for="{{ form.username.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                <i class="bi bi-envelope mr-2"></i>Email address
            </label>
            <div class="relative">
                {{ form.username|add_class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-airtable-blue focus:border-transparent transition-colors form-field disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-50"|attr:"placeholder:Enter your email address" }}
                <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                    <i class="bi bi-person text-gray-400"></i>
                </div>
            </div>
            {% if form.username.errors %}
                <div class="mt-1 text-sm text-red-600">
                    {% for error in form.username.errors %}
                        <div class="flex items-center gap-1">
                            <i class="bi bi-exclamation-circle"></i>
                            {{ error }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>

        <!-- Password Field -->
        <div>
            <label for="{{ form.password.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                <i class="bi bi-lock mr-2"></i>Password
            </label>
            <div class="relative">
                {{ form.password|add_class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-airtable-blue focus:border-transparent transition-colors form-field disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-50"|attr:"placeholder:Enter your password" }}
                <button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center password-toggle disabled:opacity-50 disabled:cursor-not-allowed" onclick="togglePassword()">
                    <i id="password-icon" class="bi bi-eye text-gray-400 hover:text-gray-600"></i>
                </button>
            </div>
            {% if form.password.errors %}
                <div class="mt-1 text-sm text-red-600">
                    {% for error in form.password.errors %}
                        <div class="flex items-center gap-1">
                            <i class="bi bi-exclamation-circle"></i>
                            {{ error }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>

        <!-- Remember Me & Forgot Password -->
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <input id="remember-me" name="remember-me" type="checkbox" class="h-4 w-4 text-airtable-blue focus:ring-airtable-blue border-gray-300 rounded form-field disabled:opacity-50 disabled:cursor-not-allowed">
                <label for="remember-me" class="ml-2 block text-sm text-gray-700">
                    Remember me
                </label>
            </div>
            <div class="text-sm">
                <a href="{% url 'password_reset' %}" class="font-medium text-airtable-blue hover:text-airtable-blue-light forgot-password-link disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none">
                    Forgot your password?
                </a>
            </div>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="w-full flex justify-center items-center gap-2 py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-airtable-blue hover:bg-airtable-blue-light focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-airtable-blue transition-colors submit-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-box-arrow-in-right submit-icon"></i>
            <span class="submit-text">Sign in</span>
            <div class="submit-loading hidden flex items-center gap-2">
                <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
                <span>Signing in...</span>
            </div>
        </button>

        <!-- Non-field errors -->
        {% if form.non_field_errors %}
            <div class="rounded-lg bg-red-50 p-4">
                <div class="text-sm text-red-700">
                    {% for error in form.non_field_errors %}
                        <div class="flex items-center gap-2">
                            <i class="bi bi-exclamation-circle"></i>
                            {{ error }}
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    </form>

    <!-- Additional Links -->
    <div class="text-center space-y-2">
        <p class="text-xs text-gray-500">
            By signing in, you agree to our
            <a href="#" class="text-airtable-blue hover:text-airtable-blue-light">Terms of Service</a>
            and
            <a href="#" class="text-airtable-blue hover:text-airtable-blue-light">Privacy Policy</a>
        </p>
    </div>

    <!-- Help Section -->
    <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
        <div class="flex items-start gap-3">
            <div class="flex-shrink-0">
                <i class="bi bi-question-circle text-airtable-blue text-lg"></i>
            </div>
            <div>
                <h4 class="text-sm font-medium text-gray-900 mb-1">Need help signing in?</h4>
                <p class="text-xs text-gray-600 mb-2">
                    If you're having trouble accessing your account, try resetting your password or contact our support team.
                </p>
                <a href="#" class="text-xs text-airtable-blue hover:text-airtable-blue-light font-medium support-link disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none">
                    Contact Support â†’
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    let isFormSubmitting = false;

    function handleLoginSubmit(event) {
        if (isFormSubmitting) {
            event.preventDefault();
            return false;
        }

        // Basic client-side validation
        const emailField = document.getElementById('{{ form.username.id_for_label }}');
        const passwordField = document.getElementById('{{ form.password.id_for_label }}');

        if (!emailField.value.trim()) {
            showFieldError(emailField, 'Email address is required');
            emailField.focus();
            event.preventDefault();
            return false;
        }

        if (!passwordField.value.trim()) {
            showFieldError(passwordField, 'Password is required');
            passwordField.focus();
            event.preventDefault();
            return false;
        }

        isFormSubmitting = true;

        // Show loading overlay
        document.getElementById('auth-loading-overlay').classList.remove('hidden');

        // Disable all interactive elements
        disableAllElements();

        // Show button loading state
        showSubmitButtonLoading();

        // Form will submit normally via HTML
        return true;
    }

    function disableAllElements() {
        // Disable form fields
        const formFields = document.querySelectorAll('.form-field');
        formFields.forEach(field => {
            field.disabled = true;
        });

        // Disable social buttons
        const socialButtons = document.querySelectorAll('.social-button');
        socialButtons.forEach(button => {
            button.disabled = true;
        });

        // Disable links
        const links = document.querySelectorAll('.signup-link, .forgot-password-link, .support-link');
        links.forEach(link => {
            link.style.pointerEvents = 'none';
            link.classList.add('opacity-50', 'cursor-not-allowed');
        });

        // Disable password toggle
        const passwordToggle = document.querySelector('.password-toggle');
        if (passwordToggle) {
            passwordToggle.disabled = true;
        }
    }

    function showSubmitButtonLoading() {
        const submitButton = document.querySelector('.submit-button');
        const submitIcon = submitButton.querySelector('.submit-icon');
        const submitText = submitButton.querySelector('.submit-text');
        const submitLoading = submitButton.querySelector('.submit-loading');

        submitIcon.classList.add('hidden');
        submitText.classList.add('hidden');
        submitLoading.classList.remove('hidden');
        submitButton.disabled = true;
    }

    function togglePassword() {
        if (isFormSubmitting) return;

        const passwordField = document.getElementById('{{ form.password.id_for_label }}');
        const passwordIcon = document.getElementById('password-icon');

        if (passwordField.type === 'password') {
            passwordField.type = 'text';
            passwordIcon.className = 'bi bi-eye-slash text-gray-400 hover:text-gray-600';
        } else {
            passwordField.type = 'password';
            passwordIcon.className = 'bi bi-eye text-gray-400 hover:text-gray-600';
        }
    }

    function showFieldError(field, message) {
        hideFieldError(field);
        const errorDiv = document.createElement('div');
        errorDiv.className = 'mt-1 text-sm text-red-600 field-error';
        errorDiv.innerHTML = `<div class="flex items-center gap-1"><i class="bi bi-exclamation-circle"></i>${message}</div>`;
        field.parentNode.parentNode.appendChild(errorDiv);

        // Add error styling to field
        field.classList.add('border-red-500');
        field.classList.remove('border-gray-300');
    }

    function hideFieldError(field) {
        const fieldContainer = field.parentNode.parentNode;
        const existingError = fieldContainer.querySelector('.field-error');
        if (existingError) {
            existingError.remove();
        }

        // Remove error styling
        field.classList.remove('border-red-500');
        field.classList.add('border-gray-300');
    }

    // Enhanced form validation
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('.login-form');
        const emailField = document.getElementById('{{ form.username.id_for_label }}');
        const passwordField = document.getElementById('{{ form.password.id_for_label }}');

        // Real-time validation
        emailField.addEventListener('blur', function() {
            if (isFormSubmitting) return;

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (this.value && !emailRegex.test(this.value)) {
                showFieldError(this, 'Please enter a valid email address');
            } else if (this.value) {
                hideFieldError(this);
            }
        });

        emailField.addEventListener('input', function() {
            if (this.classList.contains('border-red-500')) {
                hideFieldError(this);
            }
        });

        passwordField.addEventListener('input', function() {
            if (this.classList.contains('border-red-500')) {
                hideFieldError(this);
            }

            if (!isFormSubmitting && this.value.length > 0 && this.value.length < 6) {
                this.classList.add('border-yellow-400');
                this.classList.remove('border-gray-300');
            } else {
                this.classList.remove('border-yellow-400');
                this.classList.add('border-gray-300');
            }
        });

        // Social button click handlers
        const socialButtons = document.querySelectorAll('.social-button');
        socialButtons.forEach(button => {
            button.addEventListener('click', function() {
                if (isFormSubmitting) return;

                const text = this.querySelector('.social-text');
                const loading = this.querySelector('.social-loading');

                text.classList.add('hidden');
                loading.classList.remove('hidden');
                this.disabled = true;

                // Simulate social login process (replace with actual implementation)
                setTimeout(() => {
                    text.classList.remove('hidden');
                    loading.classList.add('hidden');
                    this.disabled = false;
                }, 2000);
            });
        });
    });

    // Prevent form resubmission on page reload
    window.addEventListener('pageshow', function(event) {
        if (event.persisted) {
            // Page was loaded from cache, reset form state
            isFormSubmitting = false;
            document.getElementById('auth-loading-overlay').classList.add('hidden');

            // Re-enable all elements
            const formFields = document.querySelectorAll('.form-field');
            formFields.forEach(field => {
                field.disabled = false;
            });

            const socialButtons = document.querySelectorAll('.social-button');
            socialButtons.forEach(button => {
                button.disabled = false;
            });

            const links = document.querySelectorAll('.signup-link, .forgot-password-link, .support-link');
            links.forEach(link => {
                link.style.pointerEvents = 'auto';
                link.classList.remove('opacity-50', 'cursor-not-allowed');
            });

            // Reset submit button
            const submitButton = document.querySelector('.submit-button');
            const submitIcon = submitButton.querySelector('.submit-icon');
            const submitText = submitButton.querySelector('.submit-text');
            const submitLoading = submitButton.querySelector('.submit-loading');

            submitIcon.classList.remove('hidden');
            submitText.classList.remove('hidden');
            submitLoading.classList.add('hidden');
            submitButton.disabled = false;
        }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        if (isFormSubmitting) return;

        if (e.key === 'Enter' && (e.target.tagName === 'INPUT')) {
            const form = document.querySelector('.login-form');
            form.requestSubmit();
        }
    });

    // Focus management
    document.addEventListener('DOMContentLoaded', function() {
        const emailField = document.getElementById('{{ form.username.id_for_label }}');
        if (emailField && !emailField.value) {
            emailField.focus();
        }
    });
</script>
{% endblock %} {
            passwordField.type = 'password';
            passwordIcon.className = 'bi bi-eye text-gray-400 hover:text-gray-600';
        }
    }

    // Enhanced form validation
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.querySelector('form');
        const emailField = document.getElementById('{{ form.username.id_for_label }}');
        const passwordField = document.getElementById('{{ form.password.id_for_label }}');

        // Real-time validation
        emailField.addEventListener('blur', function() {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (this.value && !emailRegex.test(this.value)) {
                this.classList.add('border-red-500');
                showFieldError(this, 'Please enter a valid email address');
            } else {
                this.classList.remove('border-red-500');
                hideFieldError(this);
            }
        });

        passwordField.addEventListener('input', function() {
            if (this.value.length > 0 && this.value.length < 6) {
                this.classList.add('border-yellow-500');
            } else {
                this.classList.remove('border-yellow-500');
            }
        });

        function showFieldError(field, message) {
            hideFieldError(field);
            const errorDiv = document.createElement('div');
            errorDiv.className = 'mt-1 text-sm text-red-600 field-error';
            errorDiv.innerHTML = `<i class="bi bi-exclamation-circle mr-1"></i>${message}`;
            field.parentNode.appendChild(errorDiv);
        }

        function hideFieldError(field) {
            const existingError = field.parentNode.querySelector('.field-error');
            if (existingError) {
                existingError.remove();
            }
        }

        // Form submission loading state
        form.addEventListener('submit', function() {
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;

            submitBtn.disabled = true;
            submitBtn.innerHTML = '<div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mx-auto"></div>';

            // Re-enable button after 5 seconds as fallback
            setTimeout(() => {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }, 5000);
        });
    });
</script>
{% endblock %} rounded-full text-xs">
                        <i class="bi bi-play-circle-fill"></i> In Progress
                    </span>
                {% elif field.value == 'resolved' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                        <i class="bi bi-check-circle-fill"></i> Resolved
                    </span>
                {% elif field.value == 'closed' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs">
                        <i class="bi bi-x-circle-fill"></i> Closed
                    </span>
                {% endif %}
            </div>
        {% elif field.name == 'channel' %}
            <div class="mt-2">
                {% if field.value == 'email' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                        <i class="bi bi-envelope"></i> Email
                    </span>
                {% elif field.value == 'chat' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                        <i class="bi bi-chat-dots"></i> Live Chat
                    </span>
                {% elif field.value == 'phone' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs">
                        <i class="bi bi-telephone"></i> Phone
                    </span>
                {% elif field.value == 'ticket' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs">
                        <i class="bi bi-ticket"></i> Support Ticket
                    </span>
                {% endif %}
            </div>
        {% endif %}
    {% endif %}
</div>

<script>
    // Character counter for textarea fields
    document.addEventListener('DOMContentLoaded', function() {
        const textarea = document.getElementById('{{ field.id_for_label }}');
        const counter = document.getElementById('{{ field.id_for_label }}-counter');

        if (textarea && counter && textarea.tagName === 'TEXTAREA') {
            // Update counter on load
            counter.textContent = textarea.value.length;

            // Update counter on input
            textarea.addEventListener('input', function() {
                counter.textContent = this.value.length;
            });
        }
    });
</script>

# templates/list.html
{% extends 'base.html' %}
{% load static %}

{% block title %}List View{% endblock %}
{% block browser_title %}List View - Feedback Management{% endblock %}

{% block content %}
<!-- Toolbar -->
<div class="px-5 py-3 border-b border-gray-200 flex items-center gap-4 flex-wrap">
    <div class="flex items-center gap-3 flex-wrap">
        <button class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 toolbar-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-list-ul"></i>
            List view
            <i class="bi bi-chevron-down text-xs"></i>
        </button>
        <button class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 toolbar-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-eye-slash"></i>
            Hide fields
        </button>
        <button class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 toolbar-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-funnel"></i>
            Filter
        </button>
        <button class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 toolbar-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-diagram-3"></i>
            Group
        </button>
        <button class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 toolbar-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-sort-alpha-down"></i>
            Sort
        </button>
        <button class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 toolbar-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-palette"></i>
            Color
        </button>
    </div>
    <div class="ml-auto flex items-center gap-3">
        <a href="{% url 'create_record' %}" class="flex items-center gap-1.5 px-3 py-1.5 bg-airtable-blue text-white rounded hover:bg-airtable-blue-light add-record-button disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none">
            <i class="bi bi-plus"></i>
            Add Record
        </a>
        <button class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 toolbar-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-link-45deg"></i>
            Share and sync
        </button>
        <button class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 toolbar-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-search"></i>
        </button>
    </div>
</div>

<!-- Loading Overlay -->
<div id="page-loading-overlay" class="hidden fixed inset-0 bg-white bg-opacity-75 z-50 flex items-center justify-center">
    <div class="text-center">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-airtable-blue mx-auto mb-4"></div>
        <div class="text-gray-700 font-medium">Loading...</div>
        <div class="text-sm text-gray-500 mt-1">Please wait while we process your request</div>
    </div>
</div>

<!-- List Container -->
<div class="flex-1 overflow-auto p-5">
    <div class="max-w-4xl mx-auto space-y-4">
        {% for record in records %}
            <div class="bg-white border border-gray-200 rounded-lg p-4 hover:border-gray-300 hover:shadow-sm transition-all cursor-pointer record-card"
                 data-record-id="{{ record.id }}" onclick="navigateToRecord({{ record.id }})">
                <div class="flex items-start justify-between mb-3">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 font-medium text-sm">
                            {{ record.id }}
                        </div>
                        <div>
                            <h3 class="font-medium text-gray-900">{{ record.title|truncatechars:50 }}</h3>
                            <div class="text-sm text-gray-500 mt-1">{{ record.user.email }}</div>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        {% if record.feedback_type == 'bug' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs">
                                <i class="bi bi-bug"></i>
                                Bug Report
                            </span>
                        {% elif record.feedback_type == 'feature' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                                <i class="bi bi-lightbulb"></i>
                                Feature Request
                            </span>
                        {% elif record.feedback_type == 'improvement' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs">
                                <i class="bi bi-tools"></i>
                                Improvement
                            </span>
                        {% elif record.feedback_type == 'praise' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                                <i class="bi bi-heart"></i>
                                Praise
                            </span>
                        {% endif %}

                        <a href="{% url 'edit_record' record.id %}" class="p-1 text-gray-400 hover:text-gray-600 edit-button disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none"
                           onclick="event.stopPropagation(); handleEditClick(event, {{ record.id }})">
                            <i class="bi bi-pencil"></i>
                        </a>
                        <div class="relative">
                            <button class="p-1 text-gray-400 hover:text-gray-600 dropdown-button disabled:opacity-50 disabled:cursor-not-allowed"
                                    onclick="event.stopPropagation(); toggleDropdown({{ record.id }})">
                                <i class="bi bi-three-dots"></i>
                            </button>
                            <div id="dropdown-{{ record.id }}" class="hidden absolute right-0 top-full mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10">
                                <a href="{% url 'edit_record' record.id %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 menu-item" onclick="handleMenuClick(event, 'edit', {{ record.id }})">
                                    <i class="bi bi-pencil mr-2"></i>Edit record
                                </a>
                                <form method="post" action="{% url 'duplicate_record' record.id %}" class="inline-block w-full duplicate-form-{{ record.id }}">
                                    {% csrf_token %}
                                    <button type="submit" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 menu-item flex items-center" onclick="handleDuplicateSubmit(event, {{ record.id }})">
                                        <i class="bi bi-files mr-2 duplicate-icon-{{ record.id }}"></i>
                                        <span class="duplicate-text-{{ record.id }}">Duplicate record</span>
                                        <div class="duplicate-loading-{{ record.id }} hidden flex items-center">
                                            <div class="animate-spin rounded-full h-3 w-3 border-b-2 border-gray-600 mr-2"></div>
                                            Duplicating...
                                        </div>
                                    </button>
                                </form>
                                <button onclick="shareRecord({{ record.id }})" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 menu-item">
                                    <i class="bi bi-share mr-2"></i>Share record
                                </button>
                                <hr class="my-1">
                                <form method="post" action="{% url 'delete_record' record.id %}" class="inline-block w-full delete-form-{{ record.id }}" onsubmit="return confirmDelete(event, {{ record.id }})">
                                    {% csrf_token %}
                                    <button type="submit" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 menu-item flex items-center">
                                        <i class="bi bi-trash mr-2 delete-icon-{{ record.id }}"></i>
                                        <span class="delete-text-{{ record.id }}">Delete record</span>
                                        <div class="delete-loading-{{ record.id }} hidden flex items-center">
                                            <div class="animate-spin rounded-full h-3 w-3 border-b-2 border-red-600 mr-2"></div>
                                            Deleting...
                                        </div>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-sm text-gray-700 mb-3 line-clamp-2">
                    {{ record.description|truncatechars:150 }}
                </div>
                <div class="flex items-center gap-4 text-xs text-gray-500">
                    <div class="flex items-center gap-1">
                        {% if record.channel == 'email' %}
                            <i class="bi bi-envelope"></i>
                            Email
                        {% elif record.channel == 'chat' %}
                            <i class="bi bi-chat-dots"></i>
                            Live Chat
                        {% elif record.channel == 'phone' %}
                            <i class="bi bi-telephone"></i>
                            Phone
                        {% elif record.channel == 'ticket' %}
                            <i class="bi bi-ticket"></i>
                            Support Ticket
                        {% endif %}
                    </div>
                    <div class="flex items-center gap-1">
                        {% if record.priority == 'urgent' %}
                            <i class="bi bi-exclamation-triangle text-red-500"></i>
                            Urgent
                        {% elif record.priority == 'high' %}
                            <i class="bi bi-exclamation-triangle text-orange-500"></i>
                            High Priority
                        {% elif record.priority == 'medium' %}
                            <i class="bi bi-dash-circle text-blue-500"></i>
                            Medium Priority
                        {% elif record.priority == 'low' %}
                            <i class="bi bi-arrow-down-circle text-green-500"></i>
                            Low Priority
                        {% endif %}
                    </div>
                    <div class="flex items-center gap-1">
                        {% if record.status == 'new' %}
                            <i class="bi bi-circle-fill text-green-500"></i>
                            New
                        {% elif record.status == 'in_progress' %}
                            <i class="bi bi-play-circle-fill text-yellow-500"></i>
                            In Progress
                        {% elif record.status == 'resolved' %}
                            <i class="bi bi-check-circle-fill text-blue-500"></i>
                            Resolved
                        {% elif record.status == 'closed' %}
                            <i class="bi bi-x-circle-fill text-gray-500"></i>
                            Closed
                        {% endif %}
                    </div>
                    <div class="ml-auto">{{ record.created_at|date:"M d, Y" }}</div>
                </div>
            </div>
        {% empty %}
            <div class="text-center py-12">
                <i class="bi bi-inbox text-4xl text-gray-400 mb-4"></i>
                <h3 class="text-lg font-medium text-gray-900 mb-2">No records found</h3>
                <p class="text-gray-500 mb-4">Get started by creating your first feedback record.</p>
                <a href="{% url 'create_record' %}" class="inline-flex items-center gap-2 px-4 py-2 bg-airtable-blue text-white rounded-md hover:bg-airtable-blue-light create-first-button disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none">
                    <i class="bi bi-plus"></i>
                    Create Record
                </a>
            </div>
        {% endfor %}

        <!-- Add Record Card -->
        {% if records %}
            <a href="{% url 'create_record' %}" class="block bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors cursor-pointer add-record-card disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none" onclick="handleAddRecordClick(event)">
                <i class="bi bi-plus text-3xl text-gray-400 mb-2"></i>
                <div class="text-gray-600 font-medium mb-1">Add new feedback record</div>
                <div class="text-sm text-gray-500">Click to create a new feedback entry</div>
            </a>
        {% endif %}
    </div>
</div>

<!-- Bottom Bar -->
<div class="px-5 py-2 border-t border-gray-200 bg-gray-50 flex items-center justify-between text-xs text-gray-600">
    <div class="flex items-center gap-4">
        <span>{{ records|length }} record{{ records|length|pluralize }}</span>
        {% if has_filters %}
            <div class="flex items-center gap-2">
                <span>Filtered</span>
                <a href="{% url 'list_view' %}" class="text-blue-500 hover:text-blue-600 clear-filters-button disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none" onclick="handleClearFilters(event)">Clear</a>
            </div>
        {% endif %}
    </div>
    <div class="flex items-center gap-1">
        <i class="bi bi-list-ul"></i>
        List view
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    let isNavigating = false;
    let isActionInProgress = false;

    function showPageLoading() {
        document.getElementById('page-loading-overlay').classList.remove('hidden');
        disableAllInteractiveElements();
    }

    function hidePageLoading() {
        document.getElementById('page-loading-overlay').classList.add('hidden');
        enableAllInteractiveElements();
    }

    function disableAllInteractiveElements() {
        // Disable toolbar buttons
        const toolbarButtons = document.querySelectorAll('.toolbar-button');
        toolbarButtons.forEach(button => {
            button.disabled = true;
        });

        // Disable record cards
        const recordCards = document.querySelectorAll('.record-card');
        recordCards.forEach(card => {
            card.style.pointerEvents = 'none';
            card.classList.add('opacity-50');
        });

        // Disable add record buttons
        const addButtons = document.querySelectorAll('.add-record-button, .create-first-button, .add-record-card');
        addButtons.forEach(button => {
            if (button.tagName === 'A') {
                button.style.pointerEvents = 'none';
                button.classList.add('opacity-50');
            } else {
                button.disabled = true;
            }
        });

        // Disable edit and dropdown buttons
        const actionButtons = document.querySelectorAll('.edit-button, .dropdown-button, .clear-filters-button');
        actionButtons.forEach(button => {
            if (button.tagName === 'A') {
                button.style.pointerEvents = 'none';
                button.classList.add('opacity-50');
            } else {
                button.disabled = true;
            }
        });

        // Disable menu items
        const menuItems = document.querySelectorAll('.menu-item');
        menuItems.forEach(item => {
            item.style.pointerEvents = 'none';
            item.classList.add('opacity-50');
        });
    }

    function enableAllInteractiveElements() {
        // Enable toolbar buttons
        const toolbarButtons = document.querySelectorAll('.toolbar-button');
        toolbarButtons.forEach(button => {
            button.disabled = false;
        });

        // Enable record cards
        const recordCards = document.querySelectorAll('.record-card');
        recordCards.forEach(card => {
            card.style.pointerEvents = 'auto';
            card.classList.remove('opacity-50');
        });

        // Enable add record buttons
        const addButtons = document.querySelectorAll('.add-record-button, .create-first-button, .add-record-card');
        addButtons.forEach(button => {
            if (button.tagName === 'A') {
                button.style.pointerEvents = 'auto';
                button.classList.remove('opacity-50');
            } else {
                button.disabled = false;
            }
        });

        // Enable edit and dropdown buttons
        const actionButtons = document.querySelectorAll('.edit-button, .dropdown-button, .clear-filters-button');
        actionButtons.forEach(button => {
            if (button.tagName === 'A') {
                button.style.pointerEvents = 'auto';
                button.classList.remove('opacity-50');
            } else {
                button.disabled = false;
            }
        });

        // Enable menu items
        const menuItems = document.querySelectorAll('.menu-item');
        menuItems.forEach(item => {
            item.style.pointerEvents = 'auto';
            item.classList.remove('opacity-50');
        });
    }

    function navigateToRecord(recordId) {
        if (isNavigating || isActionInProgress) return;

        isNavigating = true;
        showPageLoading();
        window.location.href = `{% url 'view_record' 0 %}`.replace('0', recordId);
    }

    function handleEditClick(event, recordId) {
        if (isNavigating || isActionInProgress) {
            event.preventDefault();
            return;
        }

        isNavigating = true;
        showPageLoading();
        // Let the link navigate normally
    }

    function handleAddRecordClick(event) {
        if (isNavigating || isActionInProgress) {
            event.preventDefault();
            return;
        }

        isNavigating = true;
        showPageLoading();
        // Let the link navigate normally
    }

    function handleClearFilters(event) {
        if (isNavigating || isActionInProgress) {
            event.preventDefault();
            return;
        }

        isNavigating = true;
        showPageLoading();
        // Let the link navigate normally
    }

    function toggleDropdown(recordId) {
        if (isNavigating || isActionInProgress) return;

        // Close all other dropdowns
        document.querySelectorAll('[id^="dropdown-"]').forEach(dropdown => {
            if (dropdown.id !== `dropdown-${recordId}`) {
                dropdown.classList.add('hidden');
            }
        });

        // Toggle current dropdown
        const dropdown = document.getElementById(`dropdown-${recordId}`);
        dropdown.classList.toggle('hidden');
    }

    function handleMenuClick(event, action, recordId) {
        if (isNavigating || isActionInProgress) {
            event.preventDefault();
            return;
        }

        if (action === 'edit') {
            isNavigating = true;
            showPageLoading();
            // Let the link navigate normally
        }
    }

    function handleDuplicateSubmit(event, recordId) {
        if (isNavigating || isActionInProgress) {
            event.preventDefault();
            return;
        }

        isActionInProgress = true;

        // Show loading state for this specific button
        const icon = document.querySelector(`.duplicate-icon-${recordId}`);
        const text = document.querySelector(`.duplicate-text-${recordId}`);
        const loading = document.querySelector(`.duplicate-loading-${recordId}`);

        icon.classList.add('hidden');
        text.classList.add('hidden');
        loading.classList.remove('hidden');

        // Disable all interactive elements
        disableAllInteractiveElements();

        // Form will submit normally
        return true;
    }

    function shareRecord(recordId) {
        if (isNavigating || isActionInProgress) return;

        const shareUrl = `${window.location.origin}{% url 'view_record' 0 %}`.replace('0', recordId);
        navigator.clipboard.writeText(shareUrl).then(() => {
            showNotification('Share link copied to clipboard!', 'success');
        }).catch(() => {
            showNotification('Unable to copy link', 'error');
        });
    }

    function confirmDelete(event, recordId) {
        if (isNavigating || isActionInProgress) {
            event.preventDefault();
            return false;
        }

        if (!confirm('Are you sure you want to delete this record? This action cannot be undone.')) {
            event.preventDefault();
            return false;
        }

        isActionInProgress = true;

        // Show loading state for this specific button
        const icon = document.querySelector(`.delete-icon-${recordId}`);
        const text = document.querySelector(`.delete-text-${recordId}`);
        const loading = document.querySelector(`.delete-loading-${recordId}`);

        icon.classList.add('hidden');
        text.classList.add('hidden');
        loading.classList.remove('hidden');

        // Disable all interactive elements
        disableAllInteractiveElements();

        // Form will submit normally
        return true;
    }

    function showNotification(message, type) {
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 z-50 px-4 py-2 rounded-md text-white transform transition-all duration-300 ${
            type === 'success' ? 'bg-green-500' : 'bg-red-500'
        }`;
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => notification.remove(), 300);
        }, 3000);
    }

    // Close dropdowns when clicking outside
    document.addEventListener('click', function(event) {
        if (isNavigating || isActionInProgress) return;

        if (!event.target.closest('[id^="dropdown-"]') && !event.target.closest('.dropdown-button')) {
            document.querySelectorAll('[id^="dropdown-"]').forEach(dropdown => {
                dropdown.classList.add('hidden');
            });
        }
    });

    // Handle page visibility to reset states
    document.addEventListener('visibilitychange', function() {
        if (document.visibilityState === 'visible') {
            // Reset states when page becomes visible (in case of back navigation)
            isNavigating = false;
            isActionInProgress = false;
            hidePageLoading();
        }
    });

    // Handle browser back/forward navigation
    window.addEventListener('pageshow', function(event) {
        if (event.persisted) {
            // Page was loaded from cache, reset states
            isNavigating = false;
            isActionInProgress = false;
            hidePageLoading();
        }
    });

    // Add loading states to navigation links
    document.addEventListener('DOMContentLoaded', function() {
        const links = document.querySelectorAll('a:not([target="_blank"])');
        links.forEach(link => {
            link.addEventListener('click', function(event) {
                // Only show loading for internal navigation
                if (this.href && this.href.startsWith(window.location.origin)) {
                    const isAlreadyHandled = this.classList.contains('add-record-button') ||
                                           this.classList.contains('create-first-button') ||
                                           this.classList.contains('add-record-card') ||
                                           this.classList.contains('edit-button') ||
                                           this.classList.contains('clear-filters-button');

                    if (!isAlreadyHandled && !isNavigating && !isActionInProgress) {
                        isNavigating = true;
                        showPageLoading();
                    }
                }
            });
        });
    });
</script>
{% endblock %}center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                                <i class="bi bi-lightbulb"></i>
                                Feature Request
                            </span>
                        {% elif record.feedback_type == 'improvement' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs">
                                <i class="bi bi-tools"></i>
                                Improvement
                            </span>
                        {% elif record.feedback_type == 'praise' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                                <i class="bi bi-heart"></i>
                                Praise
                            </span>
                        {% endif %}

                        <button class="p-1 text-gray-400 hover:text-gray-600"
                                onclick="event.stopPropagation(); openModal('edit', {{ record.id }})">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <div class="relative">
                            <button class="p-1 text-gray-400 hover:text-gray-600"
                                    onclick="event.stopPropagation(); toggleDropdown({{ record.id }})">
                                <i class="bi bi-three-dots"></i>
                            </button>
                            <div id="dropdown-{{ record.id }}" class="hidden absolute right-0 top-full mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10">
                                <a href="{% url 'edit_record' record.id %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                    <i class="bi bi-pencil mr-2"></i>Edit record
                                </a>
                                <button onclick="duplicateRecord({{ record.id }})" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                    <i class="bi bi-files mr-2"></i>Duplicate record
                                </button>
                                <button onclick="shareRecord({{ record.id }})" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                    <i class="bi bi-share mr-2"></i>Share record
                                </button>
                                <hr class="my-1">
                                <button onclick="deleteRecord({{ record.id }})" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50">
                                    <i class="bi bi-trash mr-2"></i>Delete record
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-sm text-gray-700 mb-3 line-clamp-2">
                    {{ record.description|truncatechars:150 }}
                </div>
                <div class="flex items-center gap-4 text-xs text-gray-500">
                    <div class="flex items-center gap-1">
                        {% if record.channel == 'email' %}
                            <i class="bi bi-envelope"></i>
                            Email
                        {% elif record.channel == 'chat' %}
                            <i class="bi bi-chat-dots"></i>
                            Live Chat
                        {% elif record.channel == 'phone' %}
                            <i class="bi bi-telephone"></i>
                            Phone
                        {% elif record.channel == 'ticket' %}
                            <i class="bi bi-ticket"></i>
                            Support Ticket
                        {% endif %}
                    </div>
                    <div class="flex items-center gap-1">
                        {% if record.priority == 'urgent' %}
                            <i class="bi bi-exclamation-triangle text-red-500"></i>
                            Urgent
                        {% elif record.priority == 'high' %}
                            <i class="bi bi-exclamation-triangle text-orange-500"></i>
                            High Priority
                        {% elif record.priority == 'medium' %}
                            <i class="bi bi-dash-circle text-blue-500"></i>
                            Medium Priority
                        {% elif record.priority == 'low' %}
                            <i class="bi bi-arrow-down-circle text-green-500"></i>
                            Low Priority
                        {% endif %}
                    </div>
                    <div class="flex items-center gap-1">
                        {% if record.status == 'new' %}
                            <i class="bi bi-circle-fill text-green-500"></i>
                            New
                        {% elif record.status == 'in_progress' %}
                            <i class="bi bi-play-circle-fill text-yellow-500"></i>
                            In Progress
                        {% elif record.status == 'resolved' %}
                            <i class="bi bi-check-circle-fill text-blue-500"></i>
                            Resolved
                        {% elif record.status == 'closed' %}
                            <i class="bi bi-x-circle-fill text-gray-500"></i>
                            Closed
                        {% endif %}
                    </div>
                    <div class="ml-auto">{{ record.created_at|date:"M d, Y" }}</div>
                </div>
            </div>
        {% empty %}
            <div class="text-center py-12">
                <i class="bi bi-inbox text-4xl text-gray-400 mb-4"></i>
                <h3 class="text-lg font-medium text-gray-900 mb-2">No records found</h3>
                <p class="text-gray-500 mb-4">Get started by creating your first feedback record.</p>
                <button class="inline-flex items-center gap-2 px-4 py-2 bg-airtable-blue text-white rounded-md hover:bg-airtable-blue-light"
                        onclick="openModal('create')">
                    <i class="bi bi-plus"></i>
                    Create Record
                </button>
            </div>
        {% endfor %}

        <!-- Add Record Card -->
        {% if records %}
            <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors cursor-pointer"
                 onclick="openModal('create')">
                <i class="bi bi-plus text-3xl text-gray-400 mb-2"></i>
                <div class="text-gray-600 font-medium mb-1">Add new feedback record</div>
                <div class="text-sm text-gray-500">Click to create a new feedback entry</div>
            </div>
        {% endif %}
    </div>
</div>

<!-- Bottom Bar -->
<div class="px-5 py-2 border-t border-gray-200 bg-gray-50 flex items-center justify-between text-xs text-gray-600">
    <div class="flex items-center gap-4">
        <span>{{ records|length }} record{{ records|length|pluralize }}</span>
        {% if has_filters %}
            <div class="flex items-center gap-2">
                <span>Filtered</span>
                <button class="text-blue-500 hover:text-blue-600" onclick="clearFilters()">Clear</button>
            </div>
        {% endif %}
    </div>
    <div class="flex items-center gap-1">
        <i class="bi bi-list-ul"></i>
        List view
    </div>
</div>

<!-- Include Modal -->
{% include 'components/modal.html' %}
{% endblock %}

{% block extra_js %}
<script>
    let currentRecordId = null;
    let currentModalMode = 'view';

    function openModal(mode, recordId = null) {
        currentModalMode = mode;
        currentRecordId = recordId;

        // Set modal title based on mode
        const modalTitle = document.getElementById('modal-title');
        const modalSaveBtn = document.getElementById('modal-save-btn');

        switch(mode) {
            case 'create':
                modalTitle.textContent = 'Create New Record';
                modalSaveBtn.textContent = 'Create Record';
                break;
            case 'edit':
                modalTitle.textContent = 'Edit Record';
                modalSaveBtn.textContent = 'Save Changes';
                break;
            case 'view':
            default:
                modalTitle.textContent = 'Record Details';
                modalSaveBtn.textContent = 'Close';
                break;
        }

        // Load modal content via AJAX or direct navigation
        if (mode === 'create') {
            window.location.href = "{% url 'create_record' %}?modal=1";
        } else if (mode === 'edit' && recordId) {
            window.location.href = `{% url 'edit_record' 0 %}`.replace('0', recordId) + '?modal=1';
        } else if (mode === 'view' && recordId) {
            window.location.href = `{% url 'view_record' 0 %}`.replace('0', recordId) + '?modal=1';
        }
    }

    function toggleDropdown(recordId) {
        // Close all other dropdowns
        document.querySelectorAll('[id^="dropdown-"]').forEach(dropdown => {
            if (dropdown.id !== `dropdown-${recordId}`) {
                dropdown.classList.add('hidden');
            }
        });

        // Toggle current dropdown
        const dropdown = document.getElementById(`dropdown-${recordId}`);
        dropdown.classList.toggle('hidden');
    }

    function duplicateRecord(recordId) {
        if (confirm('Are you sure you want to duplicate this record?')) {
            fetch(`{% url 'duplicate_record' 0 %}`.replace('0', recordId), {
                method: 'POST',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}',
                    'Content-Type': 'application/json',
                },
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                } else {
                    alert('Error duplicating record');
                }
            });
        }
    }

    function shareRecord(recordId) {
        const shareUrl = `${window.location.origin}{% url 'view_record' 0 %}`.replace('0', recordId);
        navigator.clipboard.writeText(shareUrl).then(() => {
            showNotification('Share link copied to clipboard!', 'success');
        });
    }

    function deleteRecord(recordId) {
        if (confirm('Are you sure you want to delete this record? This action cannot be undone.')) {
            fetch(`{% url 'delete_record' 0 %}`.replace('0', recordId), {
                method: 'DELETE',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}',
                },
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                } else {
                    alert('Error deleting record');
                }
            });
        }
    }

    function showNotification(message, type) {
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 z-50 px-4 py-2 rounded-md text-white transform transition-all duration-300 ${
            type === 'success' ? 'bg-green-500' : 'bg-red-500'
        }`;
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => notification.remove(), 300);
        }, 3000);
    }

    function clearFilters() {
        window.location.href = "{% url 'list_view' %}";
    }

    // Close dropdowns when clicking outside
    document.addEventListener('click', function(event) {
        if (!event.target.closest('[id^="dropdown-"]') && !event.target.closest('.bi-three-dots')) {
            document.querySelectorAll('[id^="dropdown-"]').forEach(dropdown => {
                dropdown.classList.add('hidden');
            });
        }
    });
</script>
{% endblock %}

# templates/details.html
{% extends 'base.html' %}
{% load static %}

{% block title %}
    {% if object %}Record #{{ object.id }}{% else %}Create Record{% endif %}
{% endblock %}

{% block browser_title %}
    {% if object %}Record Details - Feedback Management{% else %}Create Record - Feedback Management{% endif %}
{% endblock %}

{% block content %}
<!-- Record Navigation -->
<div class="px-5 py-3 border-b border-gray-200 flex items-center justify-between">
    <div class="flex items-center gap-3">
        <a href="{% url 'list_view' %}" class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 back-button disabled:opacity-50 disabled:cursor-not-allowed">
            <i class="bi bi-arrow-left"></i>
            Back to List
        </a>
        {% if object %}
            <div class="text-sm text-gray-500">
                Record {{ object.id }} of {{ total_records }}
            </div>
        {% endif %}
    </div>
    {% if object %}
        <div class="flex items-center gap-2">
            {% if prev_record %}
                <a href="{% url 'view_record' prev_record.id %}" class="p-1.5 border border-gray-300 rounded bg-white text-gray-600 hover:bg-gray-50 nav-button disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none">
                    <i class="bi bi-chevron-left"></i>
                </a>
            {% else %}
                <div class="p-1.5 border border-gray-200 rounded bg-gray-50 text-gray-400">
                    <i class="bi bi-chevron-left"></i>
                </div>
            {% endif %}

            {% if next_record %}
                <a href="{% url 'view_record' next_record.id %}" class="p-1.5 border border-gray-300 rounded bg-white text-gray-600 hover:bg-gray-50 nav-button disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none">
                    <i class="bi bi-chevron-right"></i>
                </a>
            {% else %}
                <div class="p-1.5 border border-gray-200 rounded bg-gray-50 text-gray-400">
                    <i class="bi bi-chevron-right"></i>
                </div>
            {% endif %}

            <div class="relative ml-2">
                <button class="flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 rounded bg-white text-sm text-gray-700 hover:bg-gray-50 action-menu-button disabled:opacity-50 disabled:cursor-not-allowed" onclick="toggleActionsMenu()">
                    <i class="bi bi-three-dots"></i>
                </button>
                <div id="actions-menu" class="hidden absolute right-0 top-full mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg py-1 z-10">
                    <a href="{% url 'edit_record' object.id %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 menu-item">
                        <i class="bi bi-pencil mr-2"></i>Edit record
                    </a>
                    <form method="post" action="{% url 'duplicate_record' object.id %}" class="inline-block w-full duplicate-form">
                        {% csrf_token %}
                        <button type="submit" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 menu-item flex items-center">
                            <i class="bi bi-files mr-2"></i>
                            <span class="duplicate-text">Duplicate record</span>
                            <div class="duplicate-loading hidden flex items-center">
                                <div class="animate-spin rounded-full h-3 w-3 border-b-2 border-gray-600 mr-2"></div>
                                Duplicating...
                            </div>
                        </button>
                    </form>
                    <button onclick="shareRecord()" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 menu-item">
                        <i class="bi bi-share mr-2"></i>Share record
                    </button>
                    <hr class="my-1">
                    <form method="post" action="{% url 'delete_record' object.id %}" class="inline-block w-full delete-form" onsubmit="return confirmDelete(event)">
                        {% csrf_token %}
                        <button type="submit" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 menu-item flex items-center">
                            <i class="bi bi-trash mr-2"></i>
                            <span class="delete-text">Delete record</span>
                            <div class="delete-loading hidden flex items-center">
                                <div class="animate-spin rounded-full h-3 w-3 border-b-2 border-red-600 mr-2"></div>
                                Deleting...
                            </div>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    {% endif %}
</div>

<!-- Record Details Form -->
<div class="flex-1 overflow-auto p-6">
    <div class="max-w-2xl mx-auto">
        {% if object %}
            <!-- Record Header -->
            <div class="mb-8">
                <div class="flex items-center gap-3 mb-2">
                    <div class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-gray-600 font-medium">
                        {{ object.id }}
                    </div>
                    <h1 class="text-2xl font-semibold text-gray-900">
                        {{ object.title|default:"Feedback Record" }}
                    </h1>
                </div>
                <div class="text-sm text-gray-500">
                    Created on {{ object.created_at|date:"F d, Y" }} â€¢ Last modified {{ object.updated_at|timesince }} ago
                </div>
            </div>
        {% else %}
            <!-- Create Record Header -->
            <div class="mb-8">
                <h1 class="text-2xl font-semibold text-gray-900">Create New Record</h1>
                <div class="text-sm text-gray-500">Fill in the details below to create a new feedback record.</div>
            </div>
        {% endif %}

        <!-- Loading Overlay for Form -->
        <div id="form-loading-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
            <div class="bg-white rounded-lg p-6 max-w-sm mx-4">
                <div class="flex items-center gap-3">
                    <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-airtable-blue"></div>
                    <span class="text-gray-700 font-medium">Processing your request...</span>
                </div>
                <div class="text-sm text-gray-500 mt-2">Please wait while we save your changes.</div>
            </div>
        </div>

        <!-- Form -->
        <form method="post" enctype="multipart/form-data" class="space-y-6 main-form" onsubmit="handleFormSubmit(event)">
            {% csrf_token %}

            {% for field in form %}
                {% include 'components/field.html' %}
            {% endfor %}

            <!-- Action Buttons -->
            <div class="flex items-center gap-3 pt-8 border-t border-gray-200 mt-8">
                {% if object %}
                    <button type="submit" class="px-4 py-2 bg-airtable-blue text-white rounded-md hover:bg-airtable-blue-light flex items-center gap-2 submit-button disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="bi bi-check submit-icon"></i>
                        <span class="submit-text">Save Changes</span>
                        <div class="submit-loading hidden flex items-center gap-2">
                            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
                            <span>Saving...</span>
                        </div>
                    </button>
                    <a href="{% url 'list_view' %}" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 flex items-center gap-2 cancel-button disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none">
                        <i class="bi bi-x"></i>
                        Cancel
                    </a>
                    <button type="button" onclick="showDeleteModal()" class="px-4 py-2 border border-red-300 text-red-700 rounded-md hover:bg-red-50 flex items-center gap-2 ml-auto delete-main-button disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="bi bi-trash"></i>
                        Delete Record
                    </button>
                {% else %}
                    <button type="submit" class="px-4 py-2 bg-airtable-blue text-white rounded-md hover:bg-airtable-blue-light flex items-center gap-2 submit-button disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="bi bi-plus submit-icon"></i>
                        <span class="submit-text">Create Record</span>
                        <div class="submit-loading hidden flex items-center gap-2">
                            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
                            <span>Creating...</span>
                        </div>
                    </button>
                    <a href="{% url 'list_view' %}" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 flex items-center gap-2 cancel-button disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none">
                        <i class="bi bi-x"></i>
                        Cancel
                    </a>
                {% endif %}
            </div>
        </form>
    </div>
</div>

<!-- Delete Confirmation Modal -->
{% if object %}
<div id="delete-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg max-w-md w-full">
        <div class="p-6">
            <div class="flex items-center gap-3 mb-4">
                <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center">
                    <i class="bi bi-exclamation-triangle text-red-600"></i>
                </div>
                <div>
                    <h3 class="text-lg font-medium text-gray-900">Delete Record</h3>
                    <p class="text-sm text-gray-500">This action cannot be undone.</p>
                </div>
            </div>
            <p class="text-gray-700 mb-6">
                Are you sure you want to delete this feedback record? All associated data will be permanently removed.
            </p>
            <div class="flex items-center gap-3">
                <form method="post" action="{% url 'delete_record' object.id %}" class="inline-block delete-modal-form">
                    {% csrf_token %}
                    <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center gap-2 delete-confirm-button disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="bi bi-trash delete-confirm-icon"></i>
                        <span class="delete-confirm-text">Yes, Delete</span>
                        <div class="delete-confirm-loading hidden flex items-center gap-2">
                            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
                            <span>Deleting...</span>
                        </div>
                    </button>
                </form>
                <button onclick="hideDeleteModal()" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 delete-cancel-button disabled:opacity-50 disabled:cursor-not-allowed">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
    let isFormSubmitting = false;

    function handleFormSubmit(event) {
        if (isFormSubmitting) {
            event.preventDefault();
            return false;
        }

        isFormSubmitting = true;

        // Show loading overlay
        document.getElementById('form-loading-overlay').classList.remove('hidden');

        // Disable all interactive elements
        disableAllInteractiveElements();

        // Show button loading state
        showSubmitButtonLoading();

        // Form will submit normally via HTML
        return true;
    }

    function disableAllInteractiveElements() {
        // Disable navigation buttons
        const navButtons = document.querySelectorAll('.back-button, .nav-button, .action-menu-button');
        navButtons.forEach(button => {
            button.classList.add('disabled:opacity-50', 'disabled:cursor-not-allowed', 'disabled:pointer-events-none');
            if (button.tagName === 'A') {
                button.style.pointerEvents = 'none';
                button.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                button.disabled = true;
            }
        });

        // Disable action buttons
        const actionButtons = document.querySelectorAll('.cancel-button, .delete-main-button');
        actionButtons.forEach(button => {
            if (button.tagName === 'A') {
                button.style.pointerEvents = 'none';
                button.classList.add('opacity-50', 'cursor-not-allowed');
            } else {
                button.disabled = true;
            }
        });

        // Disable menu items
        const menuItems = document.querySelectorAll('.menu-item');
        menuItems.forEach(item => {
            item.style.pointerEvents = 'none';
            item.classList.add('opacity-50', 'cursor-not-allowed');
        });
    }

    function showSubmitButtonLoading() {
        const submitButton = document.querySelector('.submit-button');
        const submitIcon = submitButton.querySelector('.submit-icon');
        const submitText = submitButton.querySelector('.submit-text');
        const submitLoading = submitButton.querySelector('.submit-loading');

        submitIcon.classList.add('hidden');
        submitText.classList.add('hidden');
        submitLoading.classList.remove('hidden');
        submitButton.disabled = true;
    }

    function toggleActionsMenu() {
        if (isFormSubmitting) return;

        const menu = document.getElementById('actions-menu');
        menu.classList.toggle('hidden');
    }

    function shareRecord() {
        const shareUrl = window.location.href;
        navigator.clipboard.writeText(shareUrl).then(() => {
            showNotification('Share link copied to clipboard!', 'success');
        }).catch(() => {
            showNotification('Unable to copy link', 'error');
        });
    }

    function showDeleteModal() {
        if (isFormSubmitting) return;
        document.getElementById('delete-modal').classList.remove('hidden');
    }

    function hideDeleteModal() {
        document.getElementById('delete-modal').classList.add('hidden');
    }

    function confirmDelete(event) {
        event.preventDefault();

        if (isFormSubmitting) return false;

        isFormSubmitting = true;

        // Show loading on delete button
        const deleteButton = event.target.querySelector('button[type="submit"]');
        const deleteText = deleteButton.querySelector('.delete-text');
        const deleteLoading = deleteButton.querySelector('.delete-loading');

        deleteText.classList.add('hidden');
        deleteLoading.classList.remove('hidden');
        deleteButton.disabled = true;

        // Disable all other buttons
        disableAllInteractiveElements();

        // Submit the form
        event.target.submit();

        return false;
    }

    // Handle duplicate form submission
    document.addEventListener('DOMContentLoaded', function() {
        const duplicateForm = document.querySelector('.duplicate-form');
        if (duplicateForm) {
            duplicateForm.addEventListener('submit', function(event) {
                if (isFormSubmitting) {
                    event.preventDefault();
                    return;
                }

                isFormSubmitting = true;

                const button = this.querySelector('button[type="submit"]');
                const text = button.querySelector('.duplicate-text');
                const loading = button.querySelector('.duplicate-loading');

                text.classList.add('hidden');
                loading.classList.remove('hidden');
                button.disabled = true;

                disableAllInteractiveElements();
            });
        }

        // Handle delete modal form
        const deleteModalForm = document.querySelector('.delete-modal-form');
        if (deleteModalForm) {
            deleteModalForm.addEventListener('submit', function(event) {
                if (isFormSubmitting) {
                    event.preventDefault();
                    return;
                }

                isFormSubmitting = true;

                const button = this.querySelector('.delete-confirm-button');
                const icon = button.querySelector('.delete-confirm-icon');
                const text = button.querySelector('.delete-confirm-text');
                const loading = button.querySelector('.delete-confirm-loading');

                icon.classList.add('hidden');
                text.classList.add('hidden');
                loading.classList.remove('hidden');
                button.disabled = true;

                // Disable cancel button
                const cancelButton = document.querySelector('.delete-cancel-button');
                cancelButton.disabled = true;

                disableAllInteractiveElements();
            });
        }
    });

    function showNotification(message, type) {
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 z-50 px-4 py-2 rounded-md text-white transform transition-all duration-300 ${
            type === 'success' ? 'bg-green-500' : 'bg-red-500'
        }`;
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => notification.remove(), 300);
        }, 3000);
    }

    // Close actions menu when clicking outside
    document.addEventListener('click', function(event) {
        if (isFormSubmitting) return;

        const menu = document.getElementById('actions-menu');
        const button = event.target.closest('button[onclick="toggleActionsMenu()"]');

        if (!button && menu && !menu.contains(event.target)) {
            menu.classList.add('hidden');
        }
    });

    // Prevent form resubmission on page reload
    window.addEventListener('pageshow', function(event) {
        if (event.persisted) {
            // Page was loaded from cache, reset form state
            isFormSubmitting = false;
            document.getElementById('form-loading-overlay').classList.add('hidden');
        }
    });

    // Auto-save functionality (optional - debounced)
    let saveTimeout;
    let hasUnsavedChanges = false;

    document.addEventListener('DOMContentLoaded', function() {
        const formFields = document.querySelectorAll('.form-field');

        formFields.forEach(field => {
            field.addEventListener('input', function() {
                hasUnsavedChanges = true;

                clearTimeout(saveTimeout);
                saveTimeout = setTimeout(() => {
                    // Auto-save logic here (optional)
                    console.log('Auto-saving changes...');
                }, 3000);
            });
        });

        // Warn before leaving with unsaved changes
        window.addEventListener('beforeunload', function(e) {
            if (hasUnsavedChanges && !isFormSubmitting) {
                e.preventDefault();
                e.returnValue = 'You have unsaved changes. Are you sure you want to leave?';
                return e.returnValue;
            }
        });

        // Mark as saved when form is submitted
        const form = document.querySelector('.main-form');
        if (form) {
            form.addEventListener('submit', function() {
                hasUnsavedChanges = false;
            });
        }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        if (isFormSubmitting) return;

        if (e.ctrlKey || e.metaKey) {
            switch(e.key) {
                case 's':
                    e.preventDefault();
                    document.querySelector('.main-form').requestSubmit();
                    break;
                case 'Escape':
                    if (!document.getElementById('delete-modal').classList.contains('hidden')) {
                        hideDeleteModal();
                    }
                    break;
            }
        }
    });
</script>
{% endblock %}-white transform transition-all duration-300 ${
            type === 'success' ? 'bg-green-500' : 'bg-red-500'
        }`;
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => notification.remove(), 300);
        }, 3000);
    }

    // Close actions menu when clicking outside
    document.addEventListener('click', function(event) {
        const menu = document.getElementById('actions-menu');
        const button = event.target.closest('button[onclick="toggleActionsMenu()"]');

        if (!button && menu && !menu.contains(event.target)) {
            menu.classList.add('hidden');
        }
    });

    // Auto-save functionality (optional)
    let saveTimeout;
    const inputs = document.querySelectorAll('input, select, textarea');

    inputs.forEach(input => {
        input.addEventListener('input', function() {
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => {
                // Auto-save logic here
                console.log('Auto-saving changes...');
            }, 2000);
        });
    });

    // Form validation
    document.querySelector('form').addEventListener('submit', function(e) {
        const requiredFields = document.querySelectorAll('[required]');# templates/base.html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock %} - Feedback Management</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Flowbite -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'airtable-blue': '#4a67c4',
                        'airtable-blue-light': '#6b82d6'
                    }
                }
            }
        }
    </script>

    <style>
        .gradient-blue {
            background: linear-gradient(135deg, #4a67c4 0%, #6b82d6 100%);
        }
        .browser-gradient {
            background: linear-gradient(to bottom, #e8e8e8, #d0d0d0);
        }
        .modal-backdrop {
            backdrop-filter: blur(4px);
        }
    </style>

    {% block extra_css %}{% endblock %}
</head>
<body class="bg-gray-50 overflow-x-auto">
    <!-- Browser Header -->
    <div class="browser-gradient h-10 flex items-center px-3 border-b border-gray-400 min-w-max">
        <div class="flex gap-2 mr-3">
            <div class="w-3 h-3 bg-red-500 rounded-full"></div>
            <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
        </div>
        <div class="flex gap-2 mr-3">
            <div class="w-6 h-6 bg-gray-200 border border-gray-400 rounded flex items-center justify-center text-gray-600 text-xs">
                <i class="bi bi-arrow-left"></i>
            </div>
            <div class="w-6 h-6 bg-gray-200 border border-gray-400 rounded flex items-center justify-center text-gray-600 text-xs">
                <i class="bi bi-arrow-right"></i>
            </div>
            <div class="w-6 h-6 bg-gray-200 border border-gray-400 rounded flex items-center justify-center text-gray-600 text-xs">
                <i class="bi bi-arrow-clockwise"></i>
            </div>
        </div>
        <div class="flex-1 h-6 bg-white border border-gray-400 rounded px-2 flex items-center text-sm">
            <i class="bi bi-lock-fill mr-1"></i>
            {% block browser_title %}Feedback Management{% endblock %}
            <i class="bi bi-star-fill ml-1 text-yellow-500"></i>
        </div>
    </div>

    <!-- Main Header -->
    <div class="gradient-blue text-white px-5 py-3 flex items-center justify-between min-w-max">
        <div class="flex items-center gap-4">
            <button class="lg:hidden bg-white bg-opacity-15 border border-white border-opacity-30 p-1.5 rounded" onclick="toggleSidebar()">
                <i class="bi bi-list w-4 h-4"></i>
            </button>
            <div class="w-6 h-6 bg-white rounded flex items-center justify-center text-airtable-blue">
                <i class="bi bi-bar-chart-fill"></i>
            </div>
            <div class="flex items-center gap-2 text-base font-medium">
                {% block app_name %}Feedback Management{% endblock %}
                <i class="bi bi-chevron-down text-white text-opacity-70 text-sm"></i>
            </div>
            <nav class="hidden lg:flex gap-6">
                <div class="text-white {% if request.resolver_match.url_name == 'dashboard' %}border-b-2 border-white{% else %}text-opacity-80 hover:text-white{% endif %} pb-1 cursor-pointer">
                    <a href="{% url 'dashboard' %}">Data</a>
                </div>
                <div class="text-white text-opacity-80 pb-1 cursor-pointer hover:text-white">Automations</div>
                <div class="text-white text-opacity-80 pb-1 cursor-pointer hover:text-white">Interfaces</div>
                <div class="text-white text-opacity-80 pb-1 cursor-pointer hover:text-white">Forms</div>
            </nav>
        </div>
        <div class="flex items-center gap-3">
            <div class="text-white text-opacity-70 text-sm hidden md:flex items-center gap-1">
                <i class="bi bi-circle text-xs"></i>
                Saving...
            </div>
            <button class="hidden md:flex bg-white bg-opacity-15 border border-white border-opacity-30 px-3 py-1.5 rounded text-sm items-center gap-1.5">
                <i class="bi bi-arrow-clockwise"></i>
                Help
            </button>
            <button class="bg-white bg-opacity-15 border border-white border-opacity-30 px-3 py-1.5 rounded text-sm flex items-center gap-1.5">
                <i class="bi bi-share"></i>
                Share
            </button>
            {% if user.is_authenticated %}
                <div class="relative group">
                    <div class="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center font-bold text-sm cursor-pointer">
                        {{ user.first_name.0|default:user.username.0|upper }}
                    </div>
                    <div class="absolute right-0 top-full mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 hidden group-hover:block">
                        <a href="{% url 'profile' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            <i class="bi bi-person mr-2"></i>Profile
                        </a>
                        <a href="{% url 'settings' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            <i class="bi bi-gear mr-2"></i>Settings
                        </a>
                        <hr class="my-1">
                        <a href="{% url 'logout' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            <i class="bi bi-box-arrow-right mr-2"></i>Logout
                        </a>
                    </div>
                    {% if user.unread_notifications %}
                        <div class="absolute -top-0.5 -right-0.5 bg-red-500 text-white rounded-full w-4 h-4 text-xs flex items-center justify-center">
                            {{ user.unread_notifications|length }}
                        </div>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Content Area -->
    <div class="flex min-h-screen">
        {% include 'components/sidebar.html' %}

        <!-- Main Content -->
        <div class="flex-1 bg-white flex flex-col lg:ml-0">
            {% block content %}{% endblock %}
        </div>
    </div>

    <!-- Mobile Overlay -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-10 hidden lg:hidden" onclick="toggleSidebar()"></div>

    <!-- Messages -->
    {% if messages %}
        <div id="messages" class="fixed top-4 right-4 z-50 space-y-2">
            {% for message in messages %}
                <div class="px-4 py-2 rounded-md text-white transform transition-all duration-300 {% if message.tags == 'success' %}bg-green-500{% elif message.tags == 'error' %}bg-red-500{% elif message.tags == 'warning' %}bg-yellow-500{% else %}bg-blue-500{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Flowbite JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js"></script>

    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');

            if (sidebar.classList.contains('-translate-x-full')) {
                sidebar.classList.remove('-translate-x-full');
                sidebar.classList.add('translate-x-0');
                overlay.classList.remove('hidden');
            } else {
                sidebar.classList.add('-translate-x-full');
                sidebar.classList.remove('translate-x-0');
                overlay.classList.add('hidden');
            }
        }

        // Handle window resize
        window.addEventListener('resize', function() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');

            if (window.innerWidth >= 1024) {
                sidebar.classList.remove('-translate-x-full');
                sidebar.classList.add('translate-x-0');
                overlay.classList.add('hidden');
            } else {
                sidebar.classList.add('-translate-x-full');
                sidebar.classList.remove('translate-x-0');
                overlay.classList.add('hidden');
            }
        });

        // Close sidebar when clicking outside
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const menuBtn = document.querySelector('[onclick="toggleSidebar()"]');

            if (window.innerWidth < 1024 &&
                !sidebar.contains(event.target) &&
                menuBtn && !menuBtn.contains(event.target) &&
                !sidebar.classList.contains('-translate-x-full')) {
                toggleSidebar();
            }
        });

        // Auto-hide messages
        document.addEventListener('DOMContentLoaded', function() {
            const messages = document.getElementById('messages');
            if (messages) {
                setTimeout(() => {
                    messages.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        messages.remove();
                    }, 300);
                }, 3000);
            }
        });
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>

# templates/components/sidebar.html
{% load static %}

<div id="sidebar" class="w-70 lg:w-72 bg-white border-r border-gray-200 fixed lg:relative h-full z-20 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out">
    <!-- Table Selector -->
    <div class="px-4 py-4 border-b border-gray-200">
        <div class="flex items-center gap-2 text-sm font-medium text-gray-800 mb-4">
            <i class="bi bi-table"></i>
            {{ current_table|default:"Table 1" }}
            <i class="bi bi-chevron-down text-xs"></i>
        </div>
        <div class="flex items-center gap-2 text-blue-500 text-sm cursor-pointer hover:text-blue-600">
            <i class="bi bi-plus-circle"></i>
            <a href="{% url 'import_data' %}">Add or import</a>
        </div>
    </div>

    <!-- Views Section -->
    <div class="p-4">
        <div class="text-xs font-semibold text-gray-600 uppercase tracking-wide mb-2 flex items-center gap-1">
            <i class="bi bi-folder"></i>
            Views
        </div>
        <div class="mb-4 relative">
            <i class="bi bi-search absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400 text-xs"></i>
            <input type="text" class="w-full pl-6 pr-2 py-1.5 border border-gray-300 rounded text-sm bg-gray-50" placeholder="Find a view" id="view-search">
        </div>
        <div class="space-y-0.5" id="views-list">
            <div class="flex items-center gap-2 px-2 py-1.5 {% if view_type == 'grid' %}bg-blue-50 text-blue-700{% else %}text-gray-700 hover:bg-gray-50{% endif %} rounded cursor-pointer">
                <i class="bi bi-grid-3x3-gap w-4 h-4 flex items-center justify-center"></i>
                <a href="{% url 'grid_view' %}" class="flex-1">Grid view</a>
            </div>
            <div class="flex items-center gap-2 px-2 py-1.5 {% if view_type == 'list' %}bg-blue-50 text-blue-700{% else %}text-gray-700 hover:bg-gray-50{% endif %} rounded cursor-pointer">
                <i class="bi bi-list-ul w-4 h-4 flex items-center justify-center"></i>
                <a href="{% url 'list_view' %}" class="flex-1">List view</a>
            </div>
            <div class="flex items-center gap-2 px-2 py-1.5 {% if view_type == 'form' %}bg-blue-50 text-blue-700{% else %}text-gray-700 hover:bg-gray-50{% endif %} rounded cursor-pointer">
                <i class="bi bi-file-text w-4 h-4 flex items-center justify-center"></i>
                <a href="{% url 'form_view' %}" class="flex-1">Form view</a>
            </div>
        </div>
    </div>

    <!-- Create Section -->
    <div class="px-4">
        <div class="text-xs font-semibold text-gray-600 uppercase tracking-wide mb-2">Create...</div>
        <div class="space-y-0.5">
            <div class="flex items-center gap-2 px-2 py-1.5 text-gray-700 text-sm cursor-pointer hover:bg-gray-50 rounded">
                <i class="bi bi-grid-3x3-gap w-4 h-4"></i>
                <span class="flex-1">Grid</span>
                <i class="bi bi-plus text-gray-400"></i>
            </div>
            <div class="flex items-center gap-2 px-2 py-1.5 text-gray-700 text-sm cursor-pointer hover:bg-gray-50 rounded">
                <i class="bi bi-calendar w-4 h-4"></i>
                <span class="flex-1">Calendar</span>
                <i class="bi bi-plus text-gray-400"></i>
            </div>
            <div class="flex items-center gap-2 px-2 py-1.5 text-gray-700 text-sm cursor-pointer hover:bg-gray-50 rounded">
                <i class="bi bi-images w-4 h-4"></i>
                <span class="flex-1">Gallery</span>
                <i class="bi bi-plus text-gray-400"></i>
            </div>
            <div class="flex items-center gap-2 px-2 py-1.5 text-gray-700 text-sm cursor-pointer hover:bg-gray-50 rounded">
                <i class="bi bi-kanban w-4 h-4"></i>
                <span class="flex-1">Kanban</span>
                <i class="bi bi-plus text-gray-400"></i>
            </div>
            {% if user.is_premium %}
                <div class="flex items-center gap-2 px-2 py-1.5 text-gray-700 text-sm cursor-pointer hover:bg-gray-50 rounded">
                    <i class="bi bi-diagram-3 w-4 h-4"></i>
                    <span class="flex-1">Timeline</span>
                    <span class="bg-blue-200 text-blue-700 text-xs px-2 py-0.5 rounded-full">Team</span>
                    <i class="bi bi-plus text-gray-400"></i>
                </div>
                <div class="flex items-center gap-2 px-2 py-1.5 text-gray-700 text-sm cursor-pointer hover:bg-gray-50 rounded">
                    <i class="bi bi-bar-chart w-4 h-4"></i>
                    <span class="flex-1">Gantt</span>
                    <span class="bg-blue-200 text-blue-700 text-xs px-2 py-0.5 rounded-full">Team</span>
                    <i class="bi bi-plus text-gray-400"></i>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Form Section -->
    <div class="px-4 mt-6">
        <div class="flex items-center gap-2 px-2 py-1.5 text-gray-700 text-sm cursor-pointer hover:bg-gray-50 rounded">
            <i class="bi bi-file-text w-4 h-4"></i>
            <a href="{% url 'create_form' %}" class="flex-1">Form</a>
            <i class="bi bi-plus text-gray-400"></i>
        </div>
    </div>

    <!-- Tabs Section -->
    <div class="px-4 py-4 border-t border-gray-200 mt-auto">
        <div class="flex items-center gap-2 text-sm text-gray-700">
            <i class="bi bi-collection"></i>
            Tabs
            <i class="bi bi-chevron-down text-xs"></i>
        </div>
    </div>
</div>

<script>
    // View search functionality
    document.getElementById('view-search').addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        const viewItems = document.querySelectorAll('#views-list > div');

        viewItems.forEach(item => {
            const text = item.textContent.toLowerCase();
            if (text.includes(searchTerm)) {
                item.style.display = 'flex';
            } else {
                item.style.display = 'none';
            }
        });
    });
</script>

# templates/components/field.html
{% load widget_tweaks %}

<div class="space-y-2 {% if field.field.required %}required{% endif %}">
    <!-- Field Label -->
    {% if field.label %}
        <label for="{{ field.id_for_label }}" class="flex items-center gap-2 text-sm font-medium text-gray-700">
            {% if field.name == 'user' %}
                <div class="w-4 h-4 bg-orange-500 rounded flex items-center justify-center text-white text-xs">
                    <i class="bi bi-person-fill"></i>
                </div>
            {% elif field.name == 'feedback_type' %}
                <div class="w-4 h-4 bg-teal-500 rounded flex items-center justify-center text-white text-xs">
                    <i class="bi bi-circle-fill"></i>
                </div>
            {% elif field.name == 'description' %}
                <div class="w-4 h-4 bg-indigo-500 rounded flex items-center justify-center text-white text-xs">
                    <i class="bi bi-pencil-fill"></i>
                </div>
            {% elif field.name == 'channel' %}
                <div class="w-4 h-4 bg-teal-500 rounded flex items-center justify-center text-white text-xs">
                    <i class="bi bi-circle-fill"></i>
                </div>
            {% elif field.name == 'priority' %}
                <div class="w-4 h-4 bg-red-500 rounded flex items-center justify-center text-white text-xs">
                    <i class="bi bi-exclamation-triangle"></i>
                </div>
            {% elif field.name == 'status' %}
                <div class="w-4 h-4 bg-green-500 rounded flex items-center justify-center text-white text-xs">
                    <i class="bi bi-check-circle"></i>
                </div>
            {% elif field.name == 'tags' %}
                <div class="w-4 h-4 bg-purple-500 rounded flex items-center justify-center text-white text-xs">
                    <i class="bi bi-tags"></i>
                </div>
            {% elif field.field.widget.input_type == 'file' %}
                <div class="w-4 h-4 bg-gray-500 rounded flex items-center justify-center text-white text-xs">
                    <i class="bi bi-paperclip"></i>
                </div>
            {% else %}
                <div class="w-4 h-4 bg-blue-500 rounded flex items-center justify-center text-white text-xs">
                    <i class="bi bi-input-cursor"></i>
                </div>
            {% endif %}
            {{ field.label }}
            {% if field.field.required %}
                <span class="text-red-500">*</span>
            {% endif %}
        </label>
    {% endif %}

    <!-- Field Widget -->
    <div class="relative">
        {% if field.field.widget.input_type == 'select' %}
            {{ field|add_class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-airtable-blue focus:border-transparent appearance-none bg-white" }}
            <i class="bi bi-chevron-down absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"></i>

        {% elif field.field.widget.input_type == 'textarea' %}
            {{ field|add_class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-airtable-blue focus:border-transparent resize-none"|attr:"rows:4" }}
            {% if field.name == 'description' %}
                <div class="text-xs text-gray-500 mt-1">
                    <span id="{{ field.id_for_label }}-counter">0</span> characters
                </div>
            {% endif %}

        {% elif field.field.widget.input_type == 'file' %}
            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors cursor-pointer" onclick="document.getElementById('{{ field.id_for_label }}').click()">
                <i class="bi bi-cloud-upload text-2xl text-gray-400 mb-2"></i>
                <div class="text-sm text-gray-600">Drop files here or click to upload</div>
                <div class="text-xs text-gray-500 mt-1">PNG, JPG, PDF up to 10MB</div>
            </div>
            {{ field|add_class:"hidden" }}

        {% elif field.field.widget.input_type == 'checkbox' %}
            <div class="flex items-center">
                {{ field|add_class:"w-4 h-4 text-airtable-blue bg-gray-100 border-gray-300 rounded focus:ring-airtable-blue focus:ring-2" }}
                {% if field.label %}
                    <label for="{{ field.id_for_label }}" class="ml-2 text-sm text-gray-700">{{ field.label }}</label>
                {% endif %}
            </div>

        {% elif field.field.widget.input_type == 'email' %}
            {{ field|add_class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-airtable-blue focus:border-transparent"|attr:"placeholder:Enter email address" }}
            <i class="bi bi-envelope absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>

        {% elif field.field.widget.input_type == 'url' %}
            {{ field|add_class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-airtable-blue focus:border-transparent"|attr:"placeholder:https://example.com" }}
            <i class="bi bi-link-45deg absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>

        {% elif field.field.widget.input_type == 'date' %}
            {{ field|add_class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-airtable-blue focus:border-transparent" }}
            <i class="bi bi-calendar absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>

        {% elif field.field.widget.input_type == 'number' %}
            {{ field|add_class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-airtable-blue focus:border-transparent" }}
            <i class="bi bi-hash absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>

        {% else %}
            {{ field|add_class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-airtable-blue focus:border-transparent" }}
        {% endif %}
    </div>

    <!-- Field Errors -->
    {% if field.errors %}
        <div class="text-red-600 text-sm mt-1">
            {% for error in field.errors %}
                <div class="flex items-center gap-1">
                    <i class="bi bi-exclamation-circle"></i>
                    {{ error }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Field Help Text -->
    {% if field.help_text %}
        <div class="text-gray-500 text-xs mt-1">
            {{ field.help_text }}
        </div>
    {% endif %}

    <!-- Field Value Display (for read-only mode) -->
    {% if field.value and not field.field.disabled %}
        {% if field.name == 'feedback_type' %}
            <div class="mt-2">
                {% if field.value == 'bug' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs">
                        <i class="bi bi-bug"></i> Bug Report
                    </span>
                {% elif field.value == 'feature' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                        <i class="bi bi-lightbulb"></i> Feature Request
                    </span>
                {% elif field.value == 'improvement' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs">
                        <i class="bi bi-tools"></i> Improvement
                    </span>
                {% elif field.value == 'praise' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                        <i class="bi bi-heart"></i> Praise
                    </span>
                {% endif %}
            </div>
        {% elif field.name == 'priority' %}
            <div class="mt-2">
                {% if field.value == 'low' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                        <i class="bi bi-arrow-down-circle"></i> Low Priority
                    </span>
                {% elif field.value == 'medium' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                        <i class="bi bi-dash-circle"></i> Medium Priority
                    </span>
                {% elif field.value == 'high' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs">
                        <i class="bi bi-exclamation-triangle"></i> High Priority
                    </span>
                {% elif field.value == 'urgent' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs">
                        <i class="bi bi-exclamation-triangle"></i> Urgent
                    </span>
                {% endif %}
            </div>
        {% elif field.name == 'status' %}
            <div class="mt-2">
                {% if field.value == 'new' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                        <i class="bi bi-circle-fill"></i> New
                    </span>
                {% elif field.value == 'in_progress' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs">
                        <i class="bi bi-play-circle-fill"></i> In Progress
                    </span>
                {% elif field.value == 'resolved' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                        <i class="bi bi-check-circle-fill"></i> Resolved
                    </span>
                {% elif field.value == 'closed' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-800 rounded-full text-xs">
                        <i class="bi bi-x-circle-fill"></i> Closed
                    </span>
                {% endif %}
            </div>
        {% elif field.name == 'channel' %}
            <div class="mt-2">
                {% if field.value == 'email' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                        <i class="bi bi-envelope"></i> Email
                    </span>
                {% elif field.value == 'chat' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                        <i class="bi bi-chat-dots"></i> Live Chat
                    </span>
                {% elif field.value == 'phone' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs">
                        <i class="bi bi-telephone"></i> Phone
                    </span>
                {% elif field.value == 'ticket' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs">
                        <i class="bi bi-ticket"></i> Support Ticket
                    </span>
                {% endif %}
            </div>
        {% endif %}
    {% endif %}
</div>

<script>
    // Form state management and loading indicators
    function setupFormField(fieldId) {
        const field = document.getElementById(fieldId);
        if (!field) return;

        // Character counter for textarea fields
        const counter = document.getElementById(fieldId + '-counter');
        if (field.tagName === 'TEXTAREA' && counter) {
            // Update counter on load
            counter.textContent = field.value.length;

            // Update counter on input
            field.addEventListener('input', function() {
                counter.textContent = this.value.length;
            });
        }
    }

    // File upload handler with loading states
    function handleFileUpload(fieldId) {
        const fileInput = document.getElementById(fieldId);
        const uploadArea = fileInput.closest('.file-upload-area');
        const uploadContent = uploadArea.querySelector('.upload-content');
        const uploadLoading = uploadArea.querySelector('.upload-loading');
        const uploadDisabled = uploadArea.querySelector('.upload-disabled');

        // Check if form is currently submitting
        const form = fileInput.closest('form');
        if (form && form.classList.contains('submitting')) {
            return; // Don't allow uploads during form submission
        }

        fileInput.click();

        fileInput.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                // Show loading state
                uploadContent.classList.add('hidden');
                uploadLoading.classList.remove('hidden');

                // Simulate upload progress (replace with actual upload logic)
                setTimeout(() => {
                    uploadLoading.classList.add('hidden');
                    uploadContent.classList.remove('hidden');

                    // Show selected file info
                    const fileName = e.target.files[0].name;
                    const fileInfo = document.createElement('div');
                    fileInfo.className = 'text-sm text-green-600 mt-2 flex items-center gap-1';
                    fileInfo.innerHTML = `<i class="bi bi-check-circle"></i> ${fileName} selected`;

                    // Remove any existing file info
                    const existingInfo = uploadArea.querySelector('.file-info');
                    if (existingInfo) existingInfo.remove();

                    fileInfo.classList.add('file-info');
                    uploadArea.appendChild(fileInfo);
                }, 1500);
            }
        });
    }

    // Global form submission handler
    function setupFormSubmission() {
        document.addEventListener('DOMContentLoaded', function() {
            const forms = document.querySelectorAll('form');

            forms.forEach(form => {
                form.addEventListener('submit', function(e) {
                    // Prevent double submission
                    if (form.classList.contains('submitting')) {
                        e.preventDefault();
                        return;
                    }

                    // Mark form as submitting
                    form.classList.add('submitting');

                    // Disable all form fields and buttons
                    disableFormElements(form);

                    // Show loading indicators on submit buttons
                    showButtonLoading(form);

                    // Disable file upload areas
                    disableFileUploads(form);

                    // Re-enable after timeout as fallback
                    setTimeout(() => {
                        enableFormElements(form);
                        hideButtonLoading(form);
                        enableFileUploads(form);
                        form.classList.remove('submitting');
                    }, 10000);
                });
            });
        });
    }

    function disableFormElements(form) {
        const elements = form.querySelectorAll('.form-field, button:not([type="button"])');
        elements.forEach(element => {
            element.disabled = true;
            element.classList.add('disabled-state');
        });

        // Disable dropdown arrows
        const arrows = form.querySelectorAll('.select-arrow');
        arrows.forEach(arrow => {
            arrow.style.opacity = '0.3';
        });
    }

    function enableFormElements(form) {
        const elements = form.querySelectorAll('.form-field, button');
        elements.forEach(element => {
            element.disabled = false;
            element.classList.remove('disabled-state');
        });

        // Re-enable dropdown arrows
        const arrows = form.querySelectorAll('.select-arrow');
        arrows.forEach(arrow => {
            arrow.style.opacity = '1';
        });
    }

    function showButtonLoading(form) {
        const submitButtons = form.querySelectorAll('button[type="submit"]');
        submitButtons.forEach(button => {
            const originalContent = button.innerHTML;
            button.setAttribute('data-original-content', originalContent);

            // Create loading content
            const loadingContent = `
                <div class="flex items-center justify-center gap-2">
                    <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
                    <span>Processing...</span>
                </div>
            `;

            button.innerHTML = loadingContent;
            button.classList.add('loading-state');
        });
    }

    function hideButtonLoading(form) {
        const submitButtons = form.querySelectorAll('button[type="submit"].loading-state');
        submitButtons.forEach(button => {
            const originalContent = button.getAttribute('data-original-content');
            if (originalContent) {
                button.innerHTML = originalContent;
                button.removeAttribute('data-original-content');
            }
            button.classList.remove('loading-state');
        });
    }

    function disableFileUploads(form) {
        const uploadAreas = form.querySelectorAll('.file-upload-area');
        uploadAreas.forEach(area => {
            const uploadContent = area.querySelector('.upload-content');
            const uploadDisabled = area.querySelector('.upload-disabled');

            if (uploadContent && uploadDisabled) {
                uploadContent.classList.add('hidden');
                uploadDisabled.classList.remove('hidden');
            }

            area.style.pointerEvents = 'none';
            area.classList.add('opacity-50');
        });
    }

    function enableFileUploads(form) {
        const uploadAreas = form.querySelectorAll('.file-upload-area');
        uploadAreas.forEach(area => {
            const uploadContent = area.querySelector('.upload-content');
            const uploadDisabled = area.querySelector('.upload-disabled');

            if (uploadContent && uploadDisabled) {
                uploadContent.classList.remove('hidden');
                uploadDisabled.classList.add('hidden');
            }

            area.style.pointerEvents = 'auto';
            area.classList.remove('opacity-50');
        });
    }

    // Initialize form submission handling
    setupFormSubmission();

    // Auto-setup character counters and other field-specific functionality
    document.addEventListener('DOMContentLoaded', function() {
        // Setup all form fields
        const textareas = document.querySelectorAll('textarea');
        textareas.forEach(textarea => {
            setupFormField(textarea.id);
        });
    });
</script><!-- Field Value Display (for read-only mode) -->
    {% if field.value and not field.field.disabled %}
        {% if field.name == 'feedback_type' %}
            <div class="mt-2">
                {% if field.value == 'bug' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs">
                        <i class="bi bi-bug"></i> Bug Report
                    </span>
                {% elif field.value == 'feature' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                        <i class="bi bi-lightbulb"></i> Feature Request
                    </span>
                {% elif field.value == 'improvement' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs">
                        <i class="bi bi-tools"></i> Improvement
                    </span>
                {% elif field.value == 'praise' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                        <i class="bi bi-heart"></i> Praise
                    </span>
                {% endif %}
            </div>
        {% elif field.name == 'priority' %}
            <div class="mt-2">
                {% if field.value == 'low' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                        <i class="bi bi-arrow-down-circle"></i> Low Priority
                    </span>
                {% elif field.value == 'medium' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                        <i class="bi bi-dash-circle"></i> Medium Priority
                    </span>
                {% elif field.value == 'high' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs">
                        <i class="bi bi-exclamation-triangle"></i> High Priority
                    </span>
                {% elif field.value == 'urgent' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs">
                        <i class="bi bi-exclamation-triangle"></i> Urgent
                    </span>
                {% endif %}
            </div>
        {% elif field.name == 'status' %}
            <div class="mt-2">
                {% if field.value == 'new' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">
                        <i class="bi bi-circle-fill"></i> New
                    </span>
                {% elif field.value == 'in_progress' %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800